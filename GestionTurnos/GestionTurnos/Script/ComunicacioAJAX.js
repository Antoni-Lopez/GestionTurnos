var xmlHttp;
function InformacioAJAX(Cas,Dades,NomFuncioRetorn,Cami){xmlHttp=ObjecteXmlHttp();if (xmlHttp!=null){var url=(typeof Cami=="undefined"?"RecepcioAJAX.aspx":Cami);var Parametres="c="+Cas+"&d="+encodeURIComponent(Dades)+"&sid="+Math.random();xmlHttp.onreadystatechange=new Function("CanviEstat(\""+NomFuncioRetorn+"\");");xmlHttp.open("POST",url,true);xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");xmlHttp.send(Parametres);}}
function CanviEstat(NomFuncio){if (xmlHttp.readyState==4){if(xmlHttp.responseText.toLowerCase().indexOf("index.aspx?z=") != -1){window.location.href='../../../Index.aspx?z=2'}else{eval(NomFuncio+"(\""+xmlHttp.responseText+"\")");}}}
function ObjecteXmlHttp(){var xmlHttp=null;try{xmlHttp=new XMLHttpRequest();}catch(e){try{xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");}}return xmlHttp;}
